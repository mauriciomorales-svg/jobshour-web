"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[523],{523:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var r=a(7437),n=a(2265);function s(e){let{value:t,onChange:a,onSelect:s,placeholder:o="Buscar direcci\xf3n...",className:l="",useCurrentLocation:i=!0}=e,[c,d]=(0,n.useState)([]),[u,m]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1),[h,g]=(0,n.useState)(!1),x=(0,n.useRef)(null),f=(0,n.useRef)(null),v=(0,n.useCallback)(async e=>{if(e.length<3){d([]);return}m(!0);try{let t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e),"&countrycodes=cl&limit=5&addressdetails=1"),{headers:{"Accept-Language":"es"}}),a=await t.json();d(a),b(!0)}catch(e){}m(!1)},[]),j=e=>{let t=e.display_name.split(",").slice(0,3).join(",").trim();a(t),null==s||s(t,parseFloat(e.lat),parseFloat(e.lon)),d([]),b(!1)};return(0,n.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsxs)("div",{ref:f,className:"relative",children:[(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{type:"text",value:t,onChange:e=>{let t=e.target.value;a(t),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>v(t),400)},onFocus:()=>c.length>0&&b(!0),placeholder:o,className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 ".concat(l)}),u&&(0,r.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-amber-400 border-t-transparent rounded-full animate-spin"})})]}),i&&(0,r.jsx)("button",{type:"button",onClick:()=>{navigator.geolocation&&(g(!0),navigator.geolocation.getCurrentPosition(async e=>{try{var t;let r=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(e.coords.latitude,"&lon=").concat(e.coords.longitude,"&addressdetails=1"),{headers:{"Accept-Language":"es"}}),n=await r.json(),o=(null===(t=n.display_name)||void 0===t?void 0:t.split(",").slice(0,3).join(",").trim())||"Mi ubicaci\xf3n";a(o),null==s||s(o,e.coords.latitude,e.coords.longitude)}catch(t){a("Mi ubicaci\xf3n actual"),null==s||s("Mi ubicaci\xf3n actual",e.coords.latitude,e.coords.longitude)}g(!1)},()=>g(!1),{enableHighAccuracy:!0,timeout:8e3}))},disabled:h,className:"px-2 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg border border-blue-200 transition disabled:opacity-50",title:"Usar mi ubicaci\xf3n",children:h?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):(0,r.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),p&&c.length>0&&(0,r.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",children:c.map((e,t)=>(0,r.jsxs)("button",{type:"button",onClick:()=>j(e),className:"w-full text-left px-3 py-2.5 text-sm hover:bg-amber-50 border-b border-gray-100 last:border-0 transition",children:[(0,r.jsx)("span",{className:"font-medium text-gray-800",children:e.display_name.split(",")[0]}),(0,r.jsx)("span",{className:"text-gray-400 text-xs block truncate",children:e.display_name.split(",").slice(1,3).join(",")})]},t))})]})}}}]);