"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[576],{1576:function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),r=s(2265),l=s(8593);function i(e){let{user:t,onClose:s}=e,[i,n]=(0,r.useState)([]),[c,d]=(0,r.useState)({completed_jobs:0,total_earnings:0,average_rating:0,pending_jobs:0,pending_amount:0,pending_validation:0,pending_validation_amount:0,conversion_rate:0,profile_views_week:0,profile_views_employers:0,profile_views_clients:0,can_charge_more:!1}),[o,x]=(0,r.useState)(!0);(0,r.useEffect)(()=>{h()},[t.token]);let h=async()=>{try{x(!0);let e=await fetch("".concat(l.C,"/worker/metrics"),{headers:{Authorization:"Bearer ".concat(t.token)}});if(e.ok){let t=await e.json();d(t)}let s=await fetch("".concat(l.C,"/worker/jobs"),{headers:{Authorization:"Bearer ".concat(t.token)}});if(s.ok){let e=await s.json(),t=Array.isArray(e.jobs)?e.jobs:Array.isArray(e.data)?e.data:Array.isArray(e)?e:[];n(t)}else n([])}catch(e){console.error("Error loading worker data:",e),n([])}finally{x(!1)}},m=e=>{switch(e){case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";case"pending":return"bg-amber-400";default:return"bg-gray-400"}},p=e=>{switch(e){case"completed":return"Completado";case"cancelled":return"Cancelado";case"pending":return"Pendiente";default:return"Desconocido"}},b=e=>"$"+e.toLocaleString("es-CL");return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[250] flex items-end justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-t-2xl shadow-2xl w-full max-w-md max-h-[95vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 p-5 sticky top-0 z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[t.avatarUrl?(0,a.jsx)("img",{src:t.avatarUrl,className:"w-12 h-12 rounded-full border-2 border-white object-cover",alt:t.firstName}):(0,a.jsx)("div",{className:"w-12 h-12 rounded-full border-2 border-white bg-white/30 flex items-center justify-center text-white font-bold text-lg",children:t.firstName.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-black italic text-white",children:"Mis Trabajos"}),(0,a.jsx)("p",{className:"text-xs text-white/90",children:"Historial de servicios"})]})]}),(0,a.jsx)("button",{onClick:s,className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center text-white hover:bg-white/30 transition",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-4",children:[(0,a.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-2 text-center",children:[(0,a.jsx)("p",{className:"text-xl font-black text-white",children:c.completed_jobs}),(0,a.jsx)("p",{className:"text-[10px] text-white/80",children:"Completados"})]}),(0,a.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-2 text-center",children:[(0,a.jsx)("p",{className:"text-xl font-black text-white",children:b(c.total_earnings)}),(0,a.jsx)("p",{className:"text-[10px] text-white/80",children:"Ganancias"})]}),(0,a.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-2 text-center",children:[(0,a.jsx)("p",{className:"text-xl font-black text-white",children:c.average_rating}),(0,a.jsx)("p",{className:"text-[10px] text-white/80",children:"★ Rating"})]})]}),c.pending_amount>0&&(0,a.jsx)("div",{className:"mt-3 bg-amber-500/20 backdrop-blur-sm rounded-xl p-3 border border-amber-300/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-bold text-white/90",children:"\uD83D\uDCB0 Capital Atrapado"}),(0,a.jsx)("p",{className:"text-lg font-black text-white",children:b(c.pending_amount)})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-[10px] text-white/80",children:[c.pending_jobs," trabajos"]}),(0,a.jsx)("p",{className:"text-[10px] text-white/80",children:"en proceso"})]})]})}),c.pending_validation>0&&(0,a.jsx)("div",{className:"mt-2 bg-red-500/20 backdrop-blur-sm rounded-xl p-3 border border-red-300/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-bold text-white/90",children:"⏳ Por Liquidar"}),(0,a.jsx)("p",{className:"text-lg font-black text-white",children:b(c.pending_validation_amount)})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-[10px] text-white/90 font-bold",children:[c.pending_validation," acci\xf3n",c.pending_validation>1?"es":""]}),(0,a.jsxs)("p",{className:"text-[10px] text-white/80",children:["necesaria",c.pending_validation>1?"s":""]})]})]})}),c.can_charge_more&&(0,a.jsx)("div",{className:"mt-2 bg-green-500/20 backdrop-blur-sm rounded-xl p-3 border border-green-300/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDE80"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-bold text-white",children:"Tu reputaci\xf3n te permite"}),(0,a.jsx)("p",{className:"text-sm font-black text-white",children:"Cobrar 15% m\xe1s que el promedio"})]})]})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-4 border border-blue-200/50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-xs font-bold text-slate-600",children:"Tasa de Conversi\xf3n"}),(0,a.jsxs)("span",{className:"text-2xl font-black bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:[c.conversion_rate,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(c.conversion_rate,"%")}})}),(0,a.jsx)("p",{className:"text-[10px] text-slate-500 mt-1",children:"De pendiente a liquidado"})]}),c.profile_views_week>0&&(0,a.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl p-4 border border-orange-200/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-yellow-400 rounded-xl flex items-center justify-center text-2xl shadow-lg",children:"\uD83D\uDC41️"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-bold text-slate-600",children:"Tu portafolio esta semana"}),(0,a.jsxs)("p",{className:"text-lg font-black text-slate-800",children:[c.profile_views_week," visualizaciones"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 pt-3 border-t border-orange-200",children:[(0,a.jsxs)("div",{className:"bg-white/60 rounded-lg p-2 text-center",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"\uD83C\uDFE2 Empresas"}),(0,a.jsx)("p",{className:"text-lg font-black text-blue-600",children:c.profile_views_employers})]}),(0,a.jsxs)("div",{className:"bg-white/60 rounded-lg p-2 text-center",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"\uD83D\uDC64 Clientes"}),(0,a.jsx)("p",{className:"text-lg font-black text-green-600",children:c.profile_views_clients})]})]})]})]}),(0,a.jsx)("div",{className:"px-4 pb-4 space-y-3",children:o?(0,a.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Cargando trabajos..."}):0===i.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No hay trabajos a\xfan"}):i.map(e=>(0,a.jsxs)("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(m(e.status))}),(0,a.jsx)("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full text-white ".concat(m(e.status)),children:p(e.status)})]}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e.date})]}),(0,a.jsx)("h4",{className:"text-sm font-bold text-gray-800 mb-1",children:e.service}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Cliente: ",e.clientName]}),"completed"===e.status&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-black text-green-600",children:b(e.amount)}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"text-xs text-orange-500",children:"★".repeat(e.rating)})})]}),e.review&&"completed"===e.status&&(0,a.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-100",children:(0,a.jsxs)("p",{className:"text-xs text-gray-600 italic",children:['"',e.review,'"']})})]},e.id))}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-100 sticky bottom-0 bg-white",children:(0,a.jsx)("button",{onClick:s,className:"w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-black italic py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-[1.02] transition-all",children:"Volver al Mapa"})})]})})}},8593:function(e,t,s){s.d(t,{C:function(){return a}});let a="/api"}}]);