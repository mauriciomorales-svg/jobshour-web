"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{7689:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var r=a(7437),s=a(2265),n=a(9596),o=a(8593),l=a(5398);function i(e){let{user:t,onClose:a}=e,[i,c]=(0,s.useState)("friends"),[d,x]=(0,s.useState)([]),[h,u]=(0,s.useState)([]),[m,g]=(0,s.useState)(""),[p,b]=(0,s.useState)([]),[f,j]=(0,s.useState)(""),[y,v]=(0,s.useState)(""),[N,w]=(0,s.useState)(!0),[k,C]=(0,s.useState)(!1),[D,S]=(0,s.useState)(!1),[_,E]=(0,s.useState)(null);(0,s.useEffect)(()=>{z(),B(),A()},[t.token]);let A=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{E({lat:e.coords.latitude,lng:e.coords.longitude})},e=>console.error("Error getting location:",e))},z=async()=>{try{w(!0);let e=await fetch("".concat(o.C,"/friends/list"),{headers:{Authorization:"Bearer ".concat(t.token)}});if(e.ok){let t=await e.json();x(t.friends||[])}let a=await fetch("".concat(o.C,"/friends/pending"),{headers:{Authorization:"Bearer ".concat(t.token)}});if(a.ok){let e=await a.json();u(e.requests||[])}}catch(e){console.error("Error loading friends:",e)}finally{w(!1)}},B=async()=>{try{let e=await fetch("".concat(o.C,"/friends/qr"),{headers:{Authorization:"Bearer ".concat(t.token)}});if(e.ok){let t=await e.json();j(t.qr_url)}}catch(e){console.error("Error generating QR:",e)}},q=async()=>{if(!(m.length<2))try{let e=new URLSearchParams({q:m,..._&&{lat:_.lat.toString(),lng:_.lng.toString()},...D&&{active_only:"true"},max_radius_km:"10"}),a=await fetch("".concat(o.C,"/friends/search?").concat(e),{headers:{Authorization:"Bearer ".concat(t.token)}});if(a.ok){let e=await a.json();b(e.workers||[])}}catch(e){console.error("Error searching:",e)}},R=async e=>{try{(await fetch("".concat(o.C,"/friends/request"),{method:"POST",headers:{Authorization:"Bearer ".concat(t.token),"Content-Type":"application/json"},body:JSON.stringify({user_id:e})})).ok?(alert("Solicitud enviada!"),b(p.filter(t=>t.user_id!==e))):alert("Error al enviar solicitud")}catch(e){console.error("Error sending request:",e)}},T=async()=>{if(y)try{let e=await fetch("".concat(o.C,"/friends/qr/").concat(y),{method:"POST",headers:{Authorization:"Bearer ".concat(t.token)}}),a=await e.json();e.ok?(alert("Solicitud enviada!"),v("")):alert(a.message||"QR no v\xe1lido")}catch(e){console.error("Error scanning QR:",e)}},P=async e=>{try{(await fetch("".concat(o.C,"/friends/accept/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t.token)}})).ok&&z()}catch(e){console.error("Error accepting:",e)}},X=async e=>{try{(await fetch("".concat(o.C,"/friends/reject/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t.token)}})).ok&&z()}catch(e){console.error("Error rejecting:",e)}},O=async()=>{C(!0);try{let e=await fetch("".concat(o.C,"/friends/sync-contacts"),{method:"POST",headers:{Authorization:"Bearer ".concat(t.token),"Content-Type":"application/json"},body:JSON.stringify({contacts:["user1@email.com","user2@email.com","+56912345678"]})});if(e.ok){let t=await e.json();alert("".concat(t.matches_found," contactos encontrados en Jobshour!")),z()}}catch(e){console.error("Error syncing:",e)}finally{C(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-3xl w-full max-w-lg max-h-[90vh] overflow-hidden shadow-2xl",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 p-4 flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-black italic text-white",children:"\uD83D\uDC65 Mis Amigos"}),(0,r.jsx)("button",{onClick:a,className:"text-white/80 hover:text-white",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"flex border-b",children:[{id:"friends",label:"Amigos",icon:"\uD83D\uDC65"},{id:"find",label:"Buscar",icon:"\uD83D\uDD0D"},{id:"qr",label:"QR",icon:"\uD83D\uDCF1"}].map(e=>(0,r.jsxs)("button",{onClick:()=>c(e.id),className:"flex-1 py-3 text-sm font-bold ".concat(i===e.id?"text-orange-500 border-b-2 border-orange-500 bg-orange-50":"text-gray-500"),children:[e.icon," ",e.label]},e.id))}),(0,r.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:["friends"===i&&(0,r.jsxs)("div",{className:"space-y-4",children:[h.length>0&&(0,r.jsxs)("div",{className:"bg-yellow-50 rounded-xl p-3",children:[(0,r.jsxs)("h3",{className:"text-sm font-bold text-yellow-800 mb-2",children:["Solicitudes pendientes (",h.length,")"]}),h.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-lg p-2 mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.requester.name}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("button",{onClick:()=>P(e.id),className:"px-3 py-1 bg-green-500 text-white text-xs rounded-lg",children:"Aceptar"}),(0,r.jsx)("button",{onClick:()=>X(e.id),className:"px-3 py-1 bg-gray-200 text-gray-600 text-xs rounded-lg",children:"Rechazar"})]})]},e.id))]}),(0,r.jsx)("button",{onClick:O,disabled:k,className:"w-full py-3 bg-gradient-to-r from-blue-400 to-blue-500 text-white font-bold rounded-xl shadow hover:shadow-lg transition disabled:opacity-50",children:k?"Sincronizando...":"\uD83D\uDCDE Sincronizar Agenda de Contactos"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("h3",{className:"text-sm font-bold text-gray-700",children:["Tus amigos (",d.length,")"]}),N?(0,r.jsx)("p",{className:"text-center text-gray-500",children:"Cargando..."}):0===d.length?(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-6 text-center space-y-4",children:[(0,r.jsx)("div",{className:"text-5xl mb-2",children:"\uD83D\uDC65"}),(0,r.jsx)("h3",{className:"text-lg font-black text-gray-800",children:"\xa1A\xfan no tienes compa\xf1eros en JobsHour!"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 leading-relaxed",children:["Conecta con otros trabajadores de ",(0,r.jsx)("span",{className:"font-bold text-orange-600",children:"Renaico y alrededores"}),": j\xf3venes que empiezan, personas con experiencia que buscan nuevas oportunidades, o compa\xf1eros para cubrir jobs grandes juntos."]}),(0,r.jsxs)("div",{className:"bg-white/60 rounded-xl p-4 text-left space-y-2",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-gray-600",children:"Ejemplos de colaboraci\xf3n:"}),(0,r.jsxs)("ul",{className:"text-xs text-gray-700 space-y-1",children:[(0,r.jsx)("li",{children:'• "Ayuda con mudanza" (2-3 personas)'}),(0,r.jsx)("li",{children:'• "Electricista para equipo" (maestro + ayudante)'}),(0,r.jsx)("li",{children:'• "Entregas r\xe1pidas" (cobertura en equipo)'})]})]}),(0,r.jsx)("button",{onClick:()=>c("find"),className:"w-full py-4 bg-gradient-to-r from-emerald-500 to-green-600 text-white font-black rounded-xl shadow-lg hover:shadow-xl transition text-base",children:"\uD83D\uDD0D Buscar compa\xf1eros ahora"})]}):d.map(e=>{var t;return(0,r.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center gap-3 p-3 bg-gradient-to-r from-white to-gray-50 rounded-xl border-2 border-gray-100 hover:border-orange-300 transition relative",children:[e.is_active&&(0,r.jsx)("div",{className:"absolute top-2 right-2 w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,r.jsxs)("div",{className:"w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg relative",children:[e.avatar_url?(0,r.jsx)("img",{src:e.avatar_url,alt:e.name,className:"w-full h-full rounded-full object-cover"}):e.name.charAt(0).toUpperCase(),e.is_active&&(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"font-bold text-gray-800",children:e.name}),void 0!==e.distance_km&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-bold",children:e.distance_km<1?"<1km":"".concat(e.distance_km.toFixed(1),"km")})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["@",e.nickname]}),(null===(t=e.skills)||void 0===t?void 0:t.length)>0&&(0,r.jsx)("p",{className:"text-xs text-orange-500 mt-1",children:e.skills.slice(0,3).join(", ")})]})]},e.friendship_id)})]})]}),"find"===i&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-4 text-center",children:[(0,r.jsx)("p",{className:"text-sm font-bold text-gray-700",children:"\uD83D\uDD0D Encuentra compa\xf1eros cercanos"}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Busca por nombre, habilidad o ciudad"})]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("button",{onClick:()=>S(!D),className:"px-4 py-2 rounded-lg text-sm font-bold transition ".concat(D?"bg-green-500 text-white":"bg-gray-100 text-gray-600"),children:D?"\uD83D\uDFE2 Activos ahora":"⚪ Todos"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),onKeyPress:e=>"Enter"===e.key&&q(),placeholder:"Buscar por nombre, habilidad o ciudad...",className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-400 outline-none"}),(0,r.jsx)("button",{onClick:q,className:"px-4 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold rounded-xl hover:shadow-lg transition",children:"\uD83D\uDD0D"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[0===p.length&&m.length>0&&(0,r.jsx)("p",{className:"text-center text-gray-400 py-4 text-sm",children:"No se encontraron resultados"}),p.map(e=>{var t;return(0,r.jsxs)(n.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex items-center justify-between p-4 bg-white rounded-xl border-2 border-gray-100 hover:border-orange-300 transition shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white font-bold overflow-hidden",children:e.avatar_url?(0,r.jsx)("img",{src:e.avatar_url,alt:e.nickname,className:"w-full h-full object-cover"}):null===(t=e.nickname)||void 0===t?void 0:t.charAt(0).toUpperCase()}),e.is_active&&(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"font-bold text-gray-800",children:e.name||"@".concat(e.nickname)}),void 0!==e.distance_km&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-bold",children:e.distance_km<1?"<1km":"".concat(e.distance_km.toFixed(1),"km")})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["@",e.nickname]}),e.skills&&e.skills.length>0&&(0,r.jsx)("p",{className:"text-xs text-orange-500 mt-1",children:e.skills.slice(0,2).join(", ")})]})]}),(0,r.jsxs)("button",{onClick:()=>R(e.user_id),className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-green-600 text-white text-sm font-bold rounded-lg hover:shadow-lg transition flex items-center gap-1",children:[(0,r.jsx)("span",{children:"+"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Agregar"})]})]},e.id)})]})]}),"qr"===i&&(0,r.jsxs)("div",{className:"space-y-6 text-center",children:[(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 rounded-2xl p-6 border-2 border-orange-200",children:[(0,r.jsx)("h3",{className:"text-lg font-black text-gray-800 mb-2",children:"\uD83D\uDCF1 Tu c\xf3digo QR"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 mb-4 leading-relaxed",children:["Comparte este QR con ",(0,r.jsx)("span",{className:"font-bold text-orange-600",children:"clientes habituales"})," o grupos de WhatsApp.",(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"\xa1As\xed te encuentran r\xe1pido para trabajos futuros!"})]}),f&&(0,r.jsx)("div",{className:"bg-white rounded-xl p-4 inline-block shadow-lg",children:(0,r.jsx)(l.t,{value:f,size:200,level:"H"})}),(0,r.jsxs)("button",{onClick:()=>{let e=f||"https://jobshour.dondemorales.cl/worker/".concat(t.token.split("|")[0]),a="\xa1Hola! Soy ".concat(t.firstName||t.name,", trabajador en JobsHour. Guarda mi perfil para futuros trabajos: ").concat(e);window.open("https://wa.me/?text=".concat(encodeURIComponent(a)),"_blank")},className:"mt-4 w-full py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),"Compartir por WhatsApp"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Escanear c\xf3digo"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Ingresa el c\xf3digo QR de un amigo"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value.toUpperCase()),placeholder:"JHXXXXXXXX",className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-400 outline-none text-center font-mono text-lg tracking-wider"}),(0,r.jsx)("button",{onClick:T,className:"px-6 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold rounded-xl",children:"\uD83D\uDCF7"})]})]})]})]})]})})}},8593:function(e,t,a){a.d(t,{C:function(){return r}});let r="/api"}}]);