"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{8552:function(e,t,r){r.r(t),r.d(t,{default:function(){return x}});var a=r(7437),s=r(2265),n=r(9596),l=r(5398),o=r(7586);function i(e){let{isOpen:t,onClose:r,onAdd:l,existingExperiences:i}=e,[c,d]=(0,s.useState)(""),[x,h]=(0,s.useState)([]),[u,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),[f,b]=(0,s.useState)(""),[v,j]=(0,s.useState)(""),[y,w]=(0,s.useState)("");(0,s.useEffect)(()=>{c.length>0?N():k()},[c]);let N=async()=>{m(!0);try{let e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/worker/experiences/suggestions?q=".concat(encodeURIComponent(c)),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();h(e.data||[])}}catch(e){console.error("Error searching suggestions:",e)}finally{m(!1)}},k=async()=>{m(!0);try{let e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/worker/experiences/suggestions",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();h(e.data||[])}}catch(e){console.error("Error loading suggestions:",e)}finally{m(!1)}},C=e=>{l({title:e.title}),d(""),r()},D=x.filter(e=>!i.some(t=>t.title.toLowerCase()===e.title.toLowerCase()));return t?(0,a.jsx)(o.M,{children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[300] flex items-center justify-center p-4",onClick:r,children:(0,a.jsxs)(n.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCBC"}),(0,a.jsx)("h2",{className:"text-lg font-black text-white",children:"Agregar Experiencia"})]}),(0,a.jsx)("button",{onClick:r,className:"text-white hover:bg-white/20 rounded-lg p-2 transition",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>g(!1),className:"flex-1 py-3 text-sm font-bold transition ".concat(p?"text-gray-500 hover:text-gray-700":"text-yellow-600 border-b-2 border-yellow-600"),children:"Buscar en cat\xe1logo"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"flex-1 py-3 text-sm font-bold transition ".concat(p?"text-yellow-600 border-b-2 border-yellow-600":"text-gray-500 hover:text-gray-700"),children:"Agregar personalizada"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:p?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"T\xedtulo de la experiencia *"}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),placeholder:"Ej: Electricista residencial",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-yellow-400 focus:outline-none text-sm",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Descripci\xf3n (opcional)"}),(0,a.jsx)("textarea",{value:v,onChange:e=>j(e.target.value),placeholder:"Describe brevemente tu experiencia...",rows:3,maxLength:500,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-yellow-400 focus:outline-none text-sm resize-none"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[v.length,"/500 caracteres"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"A\xf1os de experiencia (opcional)"}),(0,a.jsx)("input",{type:"number",value:y,onChange:e=>w(e.target.value?parseInt(e.target.value):""),placeholder:"Ej: 5",min:"0",max:"50",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-yellow-400 focus:outline-none text-sm"})]}),(0,a.jsx)("button",{onClick:()=>{f.trim()&&(l({title:f,description:v||void 0,years:y?Number(y):void 0}),b(""),j(""),w(""),g(!1),r())},disabled:!f.trim(),className:"w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-3 rounded-xl hover:from-yellow-500 hover:to-orange-600 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar Experiencia"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Buscar experiencia (ej: electricista, carpintero...)",className:"w-full px-4 py-3 pr-10 border-2 border-gray-200 rounded-xl focus:border-yellow-400 focus:outline-none text-sm",autoFocus:!0}),(0,a.jsx)("svg",{className:"absolute right-3 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),u?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-yellow-500 rounded-full animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Buscando..."})]}):D.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.map(e=>(0,a.jsxs)(n.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>C(e),className:"flex items-center gap-3 p-3 bg-gray-50 hover:bg-yellow-50 border border-gray-200 hover:border-yellow-400 rounded-xl transition text-left",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-gray-900 truncate",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.category})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("span",{className:"text-4xl mb-2 block",children:"\uD83D\uDD0D"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No se encontraron resultados"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"mt-3 text-sm text-yellow-600 font-bold hover:underline",children:"Agregar experiencia personalizada"})]})]})})]})})}):null}let c={wrench:"\uD83D\uDD27",zap:"⚡",paintbrush:"\uD83C\uDFA8",sparkles:"✨",hammer:"\uD83D\uDD28",leaf:"\uD83C\uDF3F",key:"\uD83D\uDD11",building:"\uD83C\uDFD7️",scissors:"✂️","paw-print":"\uD83D\uDC3E","shopping-bag":"\uD83D\uDECD️",truck:"\uD83D\uDE9A",package:"\uD83D\uDCE6"};function d(e){let{msg:t,type:r}=e;return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},className:"mt-2 px-3 py-2 rounded-lg border text-sm flex items-center gap-2 ".concat({ok:"bg-green-50 border-green-300 text-green-800",err:"bg-red-50 border-red-300 text-red-800",info:"bg-blue-50 border-blue-300 text-blue-800"}[r]),children:[(0,a.jsx)("span",{children:{ok:"✅",err:"❌",info:"ℹ️"}[r]}),(0,a.jsx)("span",{children:t})]})}function x(e){let{user:t,onClose:r,onCategorySelected:o}=e,[x,h]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[f,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(0),[y,w]=(0,s.useState)([]),[N,k]=(0,s.useState)([]),[C,D]=(0,s.useState)(null),[E,S]=(0,s.useState)(!1),[L,B]=(0,s.useState)(!1),[A,M]=(0,s.useState)(!0),[z,T]=(0,s.useState)(""),[_,I]=(0,s.useState)([]),[P,R]=(0,s.useState)(!1),[O,V]=(0,s.useState)(null),[W,F]=(0,s.useState)(!1),[H,q]=(0,s.useState)(""),J=(0,s.useRef)(null),U=(0,s.useRef)(null),G=(0,s.useRef)(null),X=(0,s.useRef)([]);(0,s.useEffect)(()=>{Y(),Q()},[]);let Y=async()=>{try{let s=localStorage.getItem("auth_token"),n=await fetch("/api/v1/worker/me",{headers:{Authorization:"Bearer ".concat(s)}});if(n.ok){var e,t,r,a;let s=await n.json();D(s.data),(null===(e=s.data)||void 0===e?void 0:e.categories)&&w(s.data.categories.map(e=>e.id)),(null===(t=s.data)||void 0===t?void 0:t.cv_path)&&m(!0),(null===(r=s.data)||void 0===r?void 0:r.video_cv_path)&&g({name:"Video existente"}),(null===(a=s.data)||void 0===a?void 0:a.bio_tarjeta)&&T(s.data.bio_tarjeta)}let l=await fetch("/api/v1/worker/experiences",{headers:{Authorization:"Bearer ".concat(s)}});if(l.ok){let e=await l.json();I(e.data||[])}}catch(e){console.error("Error fetching worker data:",e)}},Q=async()=>{try{let e=await fetch("/api/v1/categories");if(e.ok){let t=await e.json(),r=Array.isArray(t)?t:t.data||[];k(r)}}catch(e){console.error("Error fetching categories:",e)}finally{M(!1)}},K=async e=>{let t=new FormData;t.append("cv",e);try{let e=localStorage.getItem("auth_token");(await fetch("/api/v1/worker/cv",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).ok&&m(!0)}catch(e){console.error("Error uploading CV:",e)}},Z=async e=>{let t=0===y.length,r=y.includes(e)?y.filter(t=>t!==e):[...y,e];w(r);try{let e=localStorage.getItem("auth_token"),a=await fetch("/api/v1/worker/categories",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({categories:r})});t&&r.length>0&&a.ok&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(async t=>{try{await fetch("/api/v1/worker/status",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({status:"active",lat:t.coords.latitude,lng:t.coords.longitude,categories:r})}),null==o||o()}catch(e){console.error("Error activating worker mode:",e)}})}catch(e){console.error("Error updating categories:",e)}},$=async()=>{try{let e=localStorage.getItem("auth_token");await fetch("/api/v1/worker/bio-tarjeta",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({bio_tarjeta:z})})}catch(e){console.error("Error saving bio_tarjeta:",e)}},ee=async e=>{try{let t=localStorage.getItem("auth_token"),r=await fetch("/api/v1/worker/experiences",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){let e=await r.json();I([..._,e.data])}}catch(e){console.error("Error adding experience:",e)}},et=async e=>{try{let t=localStorage.getItem("auth_token");await fetch("/api/v1/worker/experiences/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),I(_.filter(t=>t.id!==e))}catch(e){console.error("Error deleting experience:",e)}},er=async e=>{let t=new FormData;t.append("video",e);try{let e=localStorage.getItem("auth_token");(await fetch("/api/v1/worker/video",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).ok&&(V({msg:"Video subido correctamente ✅",type:"ok"}),setTimeout(()=>V(null),3e3))}catch(e){console.error("Error uploading video:",e)}},ea=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0}),t=new MediaRecorder(e,{mimeType:"video/webm;codecs=vp9"});G.current=t,X.current=[],t.ondataavailable=e=>{e.data.size>0&&X.current.push(e.data)},t.onstop=()=>{let t=new Blob(X.current,{type:"video/webm"}),r=new File([t],"video-cv-".concat(Date.now(),".webm"),{type:"video/webm"});g(r),er(r),e.getTracks().forEach(e=>e.stop())},t.start(),b(!0),j(0);let r=setInterval(()=>{j(e=>e>=30?(es(),clearInterval(r),30):e+1)},1e3)}catch(e){console.error("Error accessing camera:",e),V({msg:"No se pudo acceder a la c\xe1mara. Verifica permisos.",type:"err"})}},es=()=>{G.current&&f&&(G.current.stop(),b(!1))},en="https://jobshour.dondemorales.cl/worker/".concat(null==t?void 0:t.id),el=(null==C?void 0:C.name)||(null==t?void 0:t.name)||"Mi Perfil",eo=(null==C?void 0:C.avatar)||(null==t?void 0:t.avatarUrl)||null,ei=[{label:"Foto de perfil",done:!!eo},{label:"Habilidades",done:y.length>0},{label:"Descripci\xf3n",done:z.length>10},{label:"CV o Video",done:u||!!p},{label:"Experiencia",done:_.length>0}],ec=Math.round(ei.filter(e=>e.done).length/ei.length*100),ed=async()=>{let e="\xa1Hola! Ofrezco mis servicios en JobsHour. Puedes contratarme aqu\xed: ".concat(en);if("undefined"!=typeof navigator&&navigator.share)try{await navigator.share({title:el,text:e,url:en})}catch(e){}else B(!0)};return(0,a.jsxs)("div",{className:"fixed inset-0 z-[200] bg-gray-50 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-yellow-400 via-orange-400 to-orange-500 pt-safe",children:[(0,a.jsxs)("div",{className:"relative px-4 pt-5 pb-6",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-4 right-4 w-9 h-9 bg-black/20 rounded-full flex items-center justify-center text-white",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative shrink-0",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-white/30 overflow-hidden border-2 border-white/60",children:eo?(0,a.jsx)("img",{src:eo,alt:el,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-white font-black text-3xl",children:el.charAt(0)})}),(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-green-400 border-2 border-white rounded-full"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h1",{className:"text-xl font-black text-white truncate",children:el}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:y.length>0?"".concat(y.length," habilidad").concat(y.length>1?"es":""," registrada").concat(y.length>1?"s":""):"Completa tu perfil para aparecer en el mapa"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex-1 h-2 bg-white/30 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-white rounded-full transition-all",style:{width:"".concat(ec,"%")}})}),(0,a.jsxs)("span",{className:"text-xs text-white font-bold",children:[ec,"%"]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex flex-wrap gap-1.5",children:ei.map(e=>(0,a.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded-full font-semibold ".concat(e.done?"bg-white/30 text-white":"bg-black/20 text-white/60"),children:[e.done?"✓":"○"," ",e.label]},e.label))})]}),O&&(0,a.jsx)("div",{className:"px-4 pb-3",children:(0,a.jsx)(d,{msg:O.msg,type:O.type})})]}),(0,a.jsx)("div",{className:"px-4 -mt-1 pt-4 pb-2",children:(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-4 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-xl overflow-hidden bg-white/10 border border-white/20 shrink-0",children:eo?(0,a.jsx)("img",{src:eo,alt:el,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-white font-black text-xl",children:el.charAt(0)})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-white font-black text-base truncate",children:el}),(0,a.jsx)("p",{className:"text-slate-400 text-xs mt-0.5",children:N.filter(e=>y.includes(e.id)).slice(0,2).map(e=>e.display_name).join(" \xb7 ")||"Sin habilidades a\xfan"}),z&&(0,a.jsx)("p",{className:"text-slate-300 text-xs mt-1 line-clamp-2",children:z})]}),(0,a.jsx)("div",{className:"shrink-0",children:(0,a.jsx)(l.t,{value:en,size:48,level:"L",bgColor:"transparent",fgColor:"white"})})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 mb-3",children:(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"jobshour.dondemorales.cl"})}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsxs)("button",{onClick:ed,className:"flex flex-col items-center gap-1 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-xs font-bold transition active:scale-95",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartir"]}),(0,a.jsxs)("button",{onClick:()=>{let e="\xa1Hola! Soy ".concat(el," y ofrezco mis servicios en JobsHour \uD83D\uDD27\nM\xedrame aqu\xed: ").concat(en);window.open("https://wa.me/?text=".concat(encodeURIComponent(e)),"_blank")},className:"flex flex-col items-center gap-1 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-xl text-xs font-bold transition active:scale-95",children:[(0,a.jsx)("span",{className:"text-base leading-none",children:"\uD83D\uDCAC"}),"WhatsApp"]}),(0,a.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(en),V({msg:"Enlace copiado al portapapeles",type:"ok"}),setTimeout(()=>V(null),2500)},className:"flex flex-col items-center gap-1 py-2.5 bg-slate-600 hover:bg-slate-500 text-white rounded-xl text-xs font-bold transition active:scale-95",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar link"]})]})]})}),(0,a.jsxs)("div",{className:"px-4 pb-24 space-y-3 mt-2",children:[(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},className:"bg-white rounded-2xl border-2 overflow-hidden ".concat(u?"border-green-300":"border-gray-100"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-black shrink-0 ".concat(u?"bg-green-500":"bg-gray-300"),children:u?"✓":"1"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-black text-gray-900 text-sm",children:["Sube tu CV ",(0,a.jsx)("span",{className:"text-gray-400 font-normal",children:"(opcional)"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"PDF hasta 5MB — si no tienes uno, \xa1no importa!"})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[u?(0,a.jsxs)("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-green-900",children:null==x?void 0:x.name}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:"CV subido exitosamente"})]})]}):(0,a.jsxs)("div",{onDrop:e=>{e.preventDefault();let t=e.dataTransfer.files[0];t&&"application/pdf"===t.type&&(h(t),K(t))},onDragOver:e=>e.preventDefault(),className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-yellow-400 hover:bg-yellow-50/50 transition cursor-pointer",onClick:()=>{var e;return null===(e=J.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,a.jsx)("p",{className:"text-sm font-bold text-gray-700",children:"Arrastra tu CV aqu\xed"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"o haz clic para seleccionar"}),(0,a.jsx)("input",{ref:J,type:"file",accept:"application/pdf",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(h(r),K(r))},className:"hidden"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-3 text-center italic",children:"\uD83D\uDCA1 No tienes CV? No hay problema. Tu video y habilidades son suficientes."})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.05},className:"bg-white rounded-2xl border-2 overflow-hidden ".concat(y.length>0?"border-orange-300":"border-gray-100"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-black shrink-0 ".concat(y.length>0?"bg-orange-500":"bg-gray-300"),children:y.length>0?"✓":"2"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-black text-gray-900 text-sm",children:["\xbfQu\xe9 sabes hacer? ",(0,a.jsx)("span",{className:"text-orange-500 font-bold",children:y.length>0?"".concat(y.length," elegida").concat(y.length>1?"s":""):"Elige al menos 1"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Toca los servicios que ofreces — apareces en el mapa por esto"})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[A?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-yellow-500 rounded-full animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Cargando habilidades..."})]}):0===N.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("span",{className:"text-4xl mb-2 block",children:"\uD83D\uDD27"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"No hay habilidades disponibles"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Intenta recargar la p\xe1gina"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"text",value:H,onChange:e=>q(e.target.value),placeholder:"\uD83D\uDD0D Buscar habilidad...",className:"w-full px-3 py-2 border rounded-lg text-sm mb-3 focus:outline-none focus:ring-2 focus:ring-yellow-300"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 max-h-64 overflow-y-auto",children:N.filter(e=>{var t,r;return(null===(t=e.display_name)||void 0===t?void 0:t.toLowerCase().includes(H.toLowerCase()))||(null===(r=e.name)||void 0===r?void 0:r.toLowerCase().includes(H.toLowerCase()))}).map(e=>{let t=y.includes(e.id);return(0,a.jsxs)(n.E.button,{onClick:()=>Z(e.id),whileTap:{scale:.95},className:"\n                        relative px-3 py-2 rounded-lg border-2 transition-all flex items-center gap-2\n                        ".concat(t?"border-transparent shadow-md":"border-gray-200 bg-white hover:border-gray-300","\n                      "),style:t?{background:"linear-gradient(135deg, ".concat(e.color||"#f59e0b"," 0%, ").concat(e.color||"#f59e0b","dd 100%)"),color:"white"}:{color:"#374151"},children:[(0,a.jsx)("span",{className:"text-xl",children:c[e.icon]||e.icon||"⚙️"}),(0,a.jsx)("span",{className:"text-sm font-bold whitespace-nowrap",children:e.display_name||e.name||"?"}),t&&(0,a.jsx)(n.E.div,{initial:{scale:0},animate:{scale:1},className:"w-4 h-4 bg-white rounded-full flex items-center justify-center ml-1",children:(0,a.jsx)("svg",{className:"w-3 h-3 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]},e.id)})})]}),y.length>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,a.jsxs)("button",{onClick:async()=>{try{let e=localStorage.getItem("auth_token");(await fetch("/api/v1/worker/categories",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({categories:y})})).ok?(V({msg:"Habilidades guardadas",type:"ok"}),setTimeout(()=>V(null),3e3),null==o||o()):V({msg:"Error al guardar. Intenta de nuevo.",type:"err"})}catch(e){V({msg:"Error de conexi\xf3n",type:"err"})}},className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-black text-base shadow-lg hover:from-green-600 hover:to-green-700 transition flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Guardar ",y.length," habilidad",y.length>1?"es":""]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center mt-2",children:"\uD83D\uDCCD Despu\xe9s act\xedvate en el mapa con el bot\xf3n de estado"})]})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl border-2 overflow-hidden ".concat(p?"border-green-300":"border-yellow-300"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-black shrink-0 ".concat(p?"bg-green-500":"bg-yellow-400"),children:p?"✓":"3"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-black text-gray-900 text-sm",children:["Video de presentaci\xf3n ",(0,a.jsx)("span",{className:"text-yellow-600 font-normal text-xs",children:"(recomendado)"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"30 segundos mostrando lo que haces — genera mucha m\xe1s confianza que un CV"})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[p?(0,a.jsxs)("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-green-900",children:"Video subido"}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:p.name})]})]}):(0,a.jsxs)("div",{className:"bg-black rounded-xl aspect-video flex flex-col items-center justify-center mb-4",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)("svg",{className:"w-10 h-10 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M8 5v14l11-7z"})})}),(0,a.jsx)("p",{className:"text-white text-sm font-bold",children:"Sube tu video curr\xedculum"}),(0,a.jsx)("p",{className:"text-white/70 text-xs mt-1",children:"MP4/MOV/WEBM • 30MB m\xe1x"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.click()},disabled:f,className:"flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-xl font-bold text-sm hover:from-yellow-500 hover:to-orange-600 transition shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Subir video"]}),(0,a.jsx)("button",{onClick:f?es:ea,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-bold text-sm transition shadow-md ".concat(f?"bg-gray-600 hover:bg-gray-700":"bg-red-500 hover:bg-red-600"," text-white"),children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-5 h-5 bg-white rounded-sm animate-pulse"}),(0,a.jsxs)("span",{children:[30-v,"s"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"white"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"})]}),"Grabar ahora"]})})]}),(0,a.jsx)("input",{ref:U,type:"file",accept:"video/mp4,video/quicktime,video/webm",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(g(r),er(r))},className:"hidden"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-4 text-center italic",children:"\uD83D\uDCA1 No necesitas ser experto – graba c\xf3mo haces tu trabajo. Tu energ\xeda puede abrirte puertas sin importar edad o experiencia."})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.15},className:"bg-white rounded-2xl border-2 overflow-hidden ".concat(z.length>10?"border-blue-300":"border-gray-100"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-black shrink-0 ".concat(z.length>10?"bg-blue-500":"bg-gray-300"),children:z.length>10?"✓":"4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-black text-gray-900 text-sm",children:"Tu presentaci\xf3n en una frase"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Aparece en tu tarjeta compartible — cu\xe9ntanos qui\xe9n eres"})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("textarea",{value:z,onChange:e=>T(e.target.value),onBlur:$,placeholder:"Ej: Trabajador polimorfista con pasi\xf3n por el servicio local. Siempre dispuesto a ayudar.",maxLength:150,rows:3,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-yellow-400 focus:outline-none text-sm resize-none"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[z.length,"/150 caracteres"]})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl border-2 overflow-hidden ".concat(_.length>0?"border-purple-300":"border-gray-100"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-black shrink-0 ".concat(_.length>0?"bg-purple-500":"bg-gray-300"),children:_.length>0?"✓":"5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h2",{className:"font-black text-gray-900 text-sm",children:["Tus trabajos anteriores ",(0,a.jsx)("span",{className:"text-gray-400 font-normal",children:"(opcional)"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Da m\xe1s confianza mostrar qu\xe9 has hecho antes"})]}),(0,a.jsx)("button",{onClick:()=>R(!0),className:"shrink-0 bg-purple-500 hover:bg-purple-600 text-white px-3 py-1.5 rounded-lg font-bold text-xs transition",children:"+ Agregar"})]}),(0,a.jsx)("div",{className:"p-4",children:0===_.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("span",{className:"text-4xl mb-2 block",children:"\uD83D\uDCCB"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"A\xfan no has agregado experiencias"}),(0,a.jsx)("button",{onClick:()=>R(!0),className:"text-sm text-yellow-600 font-bold hover:underline",children:"Agregar mi primera experiencia"})]}):(0,a.jsx)("div",{className:"space-y-3",children:_.map(e=>(0,a.jsx)("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-gray-900",children:e.title}),e.years&&(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:[e.years," a\xf1os de experiencia"]}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:e.description})]}),(0,a.jsx)("button",{onClick:()=>et(e.id),className:"text-red-500 hover:text-red-700 transition",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},e.id))})})]})]}),(0,a.jsx)(i,{isOpen:P,onClose:()=>R(!1),onAdd:ee,existingExperiences:_}),(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-white via-white to-transparent pointer-events-none",children:(0,a.jsxs)("div",{className:"pointer-events-auto flex gap-2",children:[(0,a.jsxs)("button",{onClick:ed,className:"flex-1 bg-gradient-to-r from-orange-400 to-orange-500 text-white py-3.5 rounded-xl font-black text-sm shadow-lg active:scale-95 transition flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartir mi tarjeta"]}),(0,a.jsx)("button",{onClick:r,className:"px-5 py-3.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-bold text-sm transition active:scale-95",children:"Cerrar"})]})})]})}},7586:function(e,t,r){r.d(t,{M:function(){return v}});var a=r(7437),s=r(2265),n=r(8881),l=r(3576),o=r(1534),i=r(4252),c=r(3537),d=r(5750);function x(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class h extends s.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let e=t.offsetParent,r=(0,c.R)(e)&&e.offsetWidth||0,a=(0,c.R)(e)&&e.offsetHeight||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left,s.bottom=a-s.height-s.top}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){var t,r;let{children:n,isPresent:l,anchorX:o,anchorY:i,root:c,pop:u}=e,m=(0,s.useId)(),p=(0,s.useRef)(null),g=(0,s.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:f}=(0,s.useContext)(d._),b=function(...e){return s.useCallback(function(...e){return t=>{let r=!1,a=e.map(e=>{let a=x(e,t);return r||"function"!=typeof a||(r=!0),a});if(r)return()=>{for(let t=0;t<a.length;t++){let r=a[t];"function"==typeof r?r():x(e[t],null)}}}}(...e),e)}(p,null!==(r=null===(t=n.props)||void 0===t?void 0:t.ref)&&void 0!==r?r:null==n?void 0:n.ref);return(0,s.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:a,right:s,bottom:n}=g.current;if(l||!1===u||!p.current||!e||!t)return;p.current.dataset.motionPopId=m;let d=document.createElement("style");f&&(d.nonce=f);let x=null!=c?c:document.head;return x.appendChild(d),d.sheet&&d.sheet.insertRule('\n          [data-motion-pop-id="'.concat(m,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===o?"left: ".concat(a):"right: ".concat(s),"px !important;\n            ").concat("bottom"===i?"bottom: ".concat(n):"top: ".concat(r),"px !important;\n          }\n        ")),()=>{x.contains(d)&&x.removeChild(d)}},[l]),(0,a.jsx)(h,{isPresent:l,childRef:p,sizeRef:g,pop:u,children:!1===u?n:s.cloneElement(n,{ref:b})})}let m=e=>{let{children:t,initial:r,isPresent:n,onExitComplete:o,custom:c,presenceAffectsLayout:d,mode:x,anchorX:h,anchorY:m,root:g}=e,f=(0,l.h)(p),b=(0,s.useId)(),v=!0,j=(0,s.useMemo)(()=>(v=!1,{id:b,initial:r,isPresent:n,custom:c,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;o&&o()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[n,f,o]);return d&&v&&(j={...j}),(0,s.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[n]),s.useEffect(()=>{n||f.size||!o||o()},[n]),t=(0,a.jsx)(u,{pop:"popLayout"===x,isPresent:n,anchorX:h,anchorY:m,root:g,children:t}),(0,a.jsx)(i.O.Provider,{value:j,children:t})};function p(){return new Map}var g=r(9637);let f=e=>e.key||"";function b(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let v=e=>{let{children:t,custom:r,initial:i=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:x="sync",propagate:h=!1,anchorX:u="left",anchorY:p="top",root:v}=e,[j,y]=(0,g.oO)(h),w=(0,s.useMemo)(()=>b(t),[t]),N=h&&!j?[]:w.map(f),k=(0,s.useRef)(!0),C=(0,s.useRef)(w),D=(0,l.h)(()=>new Map),E=(0,s.useRef)(new Set),[S,L]=(0,s.useState)(w),[B,A]=(0,s.useState)(w);(0,o.L)(()=>{k.current=!1,C.current=w;for(let e=0;e<B.length;e++){let t=f(B[e]);N.includes(t)?(D.delete(t),E.current.delete(t)):!0!==D.get(t)&&D.set(t,!1)}},[B,N.length,N.join("-")]);let M=[];if(w!==S){let e=[...w];for(let t=0;t<B.length;t++){let r=B[t],a=f(r);N.includes(a)||(e.splice(t,0,r),M.push(r))}return"wait"===x&&M.length&&(e=M),A(b(e)),L(w),null}let{forceRender:z}=(0,s.useContext)(n.p);return(0,a.jsx)(a.Fragment,{children:B.map(e=>{let t=f(e),s=(!h||!!j)&&(w===B||N.includes(t));return(0,a.jsx)(m,{isPresent:s,initial:(!k.current||!!i)&&void 0,custom:r,presenceAffectsLayout:d,mode:x,root:v,onExitComplete:s?void 0:()=>{if(E.current.has(t)||(E.current.add(t),!D.has(t)))return;D.set(t,!0);let e=!0;D.forEach(t=>{t||(e=!1)}),e&&(null==z||z(),A(C.current),h&&(null==y||y()),c&&c())},anchorX:u,anchorY:p,children:e},t)})})}}}]);