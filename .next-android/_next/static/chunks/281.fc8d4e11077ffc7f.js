"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[281],{4281:function(e,a,l){l.r(a),l.d(a,{default:function(){return o}});var s=l(7437),t=l(2265),r=l(1837);let c=[{value:"wrench",label:"\uD83D\uDD27 Herramientas"},{value:"zap",label:"⚡ Electricidad"},{value:"paintbrush",label:"\uD83C\uDFA8 Pintura"},{value:"sparkles",label:"\uD83E\uDDF9 Limpieza"},{value:"hammer",label:"\uD83E\uDEB5 Carpinter\xeda"},{value:"leaf",label:"\uD83C\uDF3F Jardiner\xeda"},{value:"key",label:"\uD83D\uDD11 Cerrajer\xeda"},{value:"building",label:"\uD83E\uDDF1 Construcci\xf3n"},{value:"scissors",label:"\uD83E\uDDF5 Costura"},{value:"paw-print",label:"\uD83D\uDC3E Mascotas"},{value:"shopping-bag",label:"\uD83D\uDECD️ Compras"},{value:"truck",label:"\uD83D\uDE9A Transporte"},{value:"package",label:"\uD83D\uDCE6 Recados"}];function o(e){let{onClose:a}=e,[l,o]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[d,u]=(0,t.useState)(null),[m,x]=(0,t.useState)(!1),[g,h]=(0,t.useState)(!1),[b,p]=(0,t.useState)(""),[v,f]=(0,t.useState)({slug:"",display_name:"",icon:"wrench",color:"#3b82f6",sort_order:0,is_active:!0});(0,t.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=localStorage.getItem("auth_token")||localStorage.getItem("token"),a=await fetch("/api/v1/categories/all",{headers:{Authorization:"Bearer ".concat(e)}}),l=await a.json();"success"===l.status&&o(l.data)}catch(e){console.error("Error cargando categor\xedas:",e),p("Error al cargar categor\xedas")}finally{i(!1)}},y=async()=>{h(!0),p("");try{let e=localStorage.getItem("auth_token")||localStorage.getItem("token"),a=await fetch(d?"/api/v1/categories/".concat(d):"/api/v1/categories",{method:d?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({slug:v.slug,display_name:v.display_name,icon:v.icon,color:v.color,sort_order:v.sort_order,is_active:v.is_active})}),l=await a.json();a.ok&&"success"===l.status?(await j(),x(!1),u(null),f({slug:"",display_name:"",icon:"wrench",color:"#3b82f6",sort_order:0,is_active:!0})):p(l.message||"Error al guardar categor\xeda")}catch(e){p(e.message||"Error de conexi\xf3n")}finally{h(!1)}},N=e=>{u(e.id),f({slug:e.slug,display_name:e.name,icon:e.icon,color:e.color,sort_order:e.sort_order,is_active:e.is_active}),x(!0)},D=async e=>{if(confirm("\xbfEst\xe1s seguro de desactivar esta categor\xeda?"))try{let a=localStorage.getItem("auth_token")||localStorage.getItem("token"),l=await (0,r.S)("/api/v1/categories/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}}),s=await l.json();l.ok&&"success"===s.status?await j():alert(s.message||"Error al eliminar categor\xeda")}catch(e){alert("Error de conexi\xf3n")}};return n?(0,s.jsx)("div",{className:"fixed inset-0 z-[400] bg-black/50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-white rounded-xl p-6",children:(0,s.jsx)("p",{children:"Cargando categor\xedas..."})})}):(0,s.jsx)("div",{className:"fixed inset-0 z-[400] bg-black/50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Gesti\xf3n de Categor\xedas"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[b&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:b}),!m&&(0,s.jsx)("button",{onClick:()=>{x(!0),u(null),f({slug:"",display_name:"",icon:"wrench",color:"#3b82f6",sort_order:l.length,is_active:!0})},className:"mb-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-bold",children:"+ Agregar Categor\xeda"}),m&&(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,s.jsx)("h3",{className:"font-bold mb-4",children:d?"Editar Categor\xeda":"Nueva Categor\xeda"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Slug (URL)"}),(0,s.jsx)("input",{type:"text",value:v.slug,onChange:e=>f({...v,slug:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"ej: gasfiteria",disabled:!!d})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nombre"}),(0,s.jsx)("input",{type:"text",value:v.display_name,onChange:e=>f({...v,display_name:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"ej: Gasfiter\xeda"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Icono"}),(0,s.jsx)("select",{value:v.icon,onChange:e=>f({...v,icon:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:c.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Color"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"color",value:v.color,onChange:e=>f({...v,color:e.target.value}),className:"w-16 h-10 border rounded"}),(0,s.jsx)("input",{type:"text",value:v.color,onChange:e=>f({...v,color:e.target.value}),className:"flex-1 px-3 py-2 border rounded-lg",placeholder:"#3b82f6"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Orden"}),(0,s.jsx)("input",{type:"number",value:v.sort_order,onChange:e=>f({...v,sort_order:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg"})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:v.is_active,onChange:e=>f({...v,is_active:e.target.checked}),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Activa"})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,s.jsx)("button",{onClick:y,disabled:g||!v.slug||!v.display_name,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Guardando...":"Guardar"}),(0,s.jsx)("button",{onClick:()=>{x(!1),u(null),f({slug:"",display_name:"",icon:"wrench",color:"#3b82f6",sort_order:0,is_active:!0})},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancelar"})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:l.map(e=>{var a;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg ".concat(e.is_active?"bg-white":"bg-gray-100 opacity-60"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:(null===(a=c.find(a=>a.value===e.icon))||void 0===a?void 0:a.label.split(" ")[0])||"\uD83D\uDCCC"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.slug})]}),(0,s.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:e.color}})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Orden: ",e.sort_order]}),!e.is_active&&(0,s.jsx)("span",{className:"text-xs bg-gray-300 px-2 py-1 rounded",children:"Inactiva"}),(0,s.jsx)("button",{onClick:()=>N(e),className:"bg-blue-100 text-blue-700 px-3 py-1 rounded text-sm hover:bg-blue-200",children:"Editar"}),(0,s.jsx)("button",{onClick:()=>D(e.id),className:"bg-red-100 text-red-700 px-3 py-1 rounded text-sm hover:bg-red-200",children:"Desactivar"})]})]},e.id)})})]})]})})}},1837:function(e,a,l){l.d(a,{S:function(){return t}});let s="https://jobshour.dondemorales.cl".replace(/\/api$/,"");async function t(e,a){return fetch(s?"".concat(s).concat(e):e,a)}}}]);