"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{2728:function(e,a,t){t.r(a),t.d(a,{default:function(){return l}});var r=t(7437),s=t(2265);function l(e){let{isOpen:a,onClose:t,serviceRequestId:l,workerName:n,workerAvatar:i,onRated:o}=e,[c,d]=(0,s.useState)(0),[u,x]=(0,s.useState)(0),[m,h]=(0,s.useState)(""),[f,g]=(0,s.useState)(!1),[b,p]=(0,s.useState)(null),j=async()=>{if(0===c){p("Por favor selecciona una calificaci\xf3n");return}if(m.trim().length<10){p("El comentario debe tener al menos 10 caracteres");return}g(!0),p(null);try{let e=localStorage.getItem("auth_token")||localStorage.getItem("token");if(!e){p("Debes iniciar sesi\xf3n para calificar"),g(!1);return}let a=await fetch("/api/v1/reviews",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({service_request_id:l,stars:c,comment:m.trim()})}),r=await a.json();a.ok&&"success"===r.status?(o(),t()):p(r.message||"Error al enviar la rese\xf1a")}catch(e){p("Error de conexi\xf3n. Por favor intenta nuevamente.")}finally{g(!1)}};return a?(0,r.jsx)("div",{className:"fixed inset-0 z-[800] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-[90%] max-w-md mx-4 overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:i||"https://i.pravatar.cc/60?u=".concat(n),alt:n,className:"w-12 h-12 rounded-full object-cover border-2 border-white"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-white font-bold text-lg",children:"Califica el Servicio"}),(0,r.jsx)("p",{className:"text-white/90 text-sm",children:n})]})]})}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-700 font-semibold mb-4",children:"\xbfC\xf3mo calificar\xedas este servicio?"}),(0,r.jsx)("div",{className:"flex items-center justify-center gap-2",children:[1,2,3,4,5].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>d(e),onMouseEnter:()=>x(e),onMouseLeave:()=>x(0),className:"focus:outline-none transition-transform hover:scale-110",children:(0,r.jsx)("svg",{className:"w-12 h-12 ".concat(e<=(u||c)?"text-yellow-400 fill-current":"text-gray-300"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e))}),c>0&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[1===c&&"\uD83D\uDE1E Muy malo",2===c&&"\uD83D\uDE10 Malo",3===c&&"\uD83D\uDE0A Regular",4===c&&"\uD83D\uDE04 Bueno",5===c&&"\uD83E\uDD29 Excelente"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comentario (m\xednimo 10 caracteres) *"}),(0,r.jsx)("textarea",{value:m,onChange:e=>h(e.target.value),placeholder:"Cu\xe9ntanos sobre tu experiencia con este servicio...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none resize-none",rows:4,maxLength:500}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[m.length,"/500 caracteres"]})]}),b&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-700",children:b})})]}),(0,r.jsxs)("div",{className:"p-6 border-t border-gray-200 flex gap-3",children:[(0,r.jsx)("button",{onClick:t,disabled:f,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition disabled:opacity-50",children:"Cancelar"}),(0,r.jsx)("button",{onClick:j,disabled:f||0===c||m.trim().length<10,className:"flex-1 px-4 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-xl font-bold hover:from-yellow-500 hover:to-orange-600 transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Enviando..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"â­"}),(0,r.jsx)("span",{children:"Enviar Rese\xf1a"})]})})]})]})}):null}}}]);