(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4976:function(e,a,t){Promise.resolve().then(t.bind(t,6683))},6683:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var s=t(7437),l=t(2265);function r(){let[e,a]=(0,l.useState)(""),[t,r]=(0,l.useState)("dashboard"),[d,n]=(0,l.useState)(null),[c,o]=(0,l.useState)([]),[i,x]=(0,l.useState)([]),[m,p]=(0,l.useState)([]),[h,u]=(0,l.useState)(""),[g,y]=(0,l.useState)(!1),[b,j]=(0,l.useState)(""),[f,N]=(0,l.useState)(1),[v,w]=(0,l.useState)(1),[C,k]=(0,l.useState)(""),[D,S]=(0,l.useState)("");(0,l.useEffect)(()=>{let e=localStorage.getItem("auth_token");e&&a(e)},[]);let _=(0,l.useCallback)(async function(a){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",s=arguments.length>2?arguments[2]:void 0,l=await fetch("/api/v1/admin".concat(a),{method:t,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},...s?{body:JSON.stringify(s)}:{}});if(403===l.status)throw Error("No autorizado. Solo admin.");if(!l.ok)throw Error("Error ".concat(l.status));return l.json()},[e]),E=(0,l.useCallback)(async()=>{try{n(await _("/stats"))}catch(e){j(e.message)}},[_]),P=(0,l.useCallback)(async()=>{y(!0);try{let e=new URLSearchParams({page:String(f)});h&&e.set("search",h),D&&e.set("type",D);let a=await _("/users?".concat(e));o(a.data),w(a.last_page)}catch(e){j(e.message)}y(!1)},[_,f,h,D]),T=(0,l.useCallback)(async()=>{y(!0);try{let e=new URLSearchParams({page:String(f)});h&&e.set("search",h),C&&e.set("status",C),D&&e.set("type",D);let a=await _("/demands?".concat(e));x(a.data),w(a.last_page)}catch(e){j(e.message)}y(!1)},[_,f,h,C,D]),A=(0,l.useCallback)(async()=>{y(!0);try{p(await _("/categories"))}catch(e){j(e.message)}y(!1)},[_]);(0,l.useEffect)(()=>{e&&(j(""),"dashboard"===t?E():"users"===t?P():"demands"===t?T():"categories"===t&&A())},[e,t,f]),(0,l.useEffect)(()=>{N(1)},[h,C,D,t]);let B=async e=>{await _("/users/".concat(e,"/toggle"),"POST"),P()},L=async e=>{confirm("\xbfCancelar esta demanda?")&&(await _("/demands/".concat(e,"/cancel"),"POST",{reason:"Cancelado por admin"}),T())},F=e=>{var a;return null!==(a=null==e?void 0:e.toLocaleString("es-CL"))&&void 0!==a?a:"0"},I=e=>new Date(e).toLocaleDateString("es-CL",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"});if(!e)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-gray-900 p-8 rounded-2xl border border-gray-800 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"\uD83D\uDD12 Admin Panel"}),(0,s.jsx)("p",{className:"text-gray-400 mb-4",children:"Inicia sesi\xf3n en JobsHours primero"}),(0,s.jsx)("a",{href:"/",className:"text-emerald-400 underline",children:"Ir al inicio"})]})});let O={pending:"bg-yellow-500/20 text-yellow-300",taken:"bg-blue-500/20 text-blue-300",accepted:"bg-blue-500/20 text-blue-300",completed:"bg-emerald-500/20 text-emerald-300",cancelled:"bg-red-500/20 text-red-300",expired:"bg-gray-500/20 text-gray-400"};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-950 text-white",children:[(0,s.jsxs)("header",{className:"bg-gray-900 border-b border-gray-800 px-6 py-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:"⚡"}),(0,s.jsx)("h1",{className:"text-xl font-bold",children:"JobsHours Admin"})]}),(0,s.jsx)("a",{href:"/",className:"text-sm text-gray-400 hover:text-white",children:"← Volver al mapa"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("nav",{className:"w-56 bg-gray-900/50 border-r border-gray-800 min-h-[calc(100vh-65px)] p-4",children:[{key:"dashboard",label:"Dashboard",icon:"\uD83D\uDCCA"},{key:"users",label:"Usuarios",icon:"\uD83D\uDC65"},{key:"demands",label:"Demandas",icon:"\uD83D\uDCCB"},{key:"categories",label:"Categor\xedas",icon:"\uD83C\uDFF7️"}].map(e=>(0,s.jsxs)("button",{onClick:()=>r(e.key),className:"w-full text-left px-4 py-3 rounded-xl mb-1 flex items-center gap-3 transition-all ".concat(t===e.key?"bg-emerald-600/20 text-emerald-400 font-bold":"text-gray-400 hover:bg-gray-800 hover:text-white"),children:[(0,s.jsx)("span",{children:e.icon})," ",e.label]},e.key))}),(0,s.jsxs)("main",{className:"flex-1 p-6",children:[b&&(0,s.jsxs)("div",{className:"bg-red-500/20 border border-red-500/30 text-red-300 px-4 py-3 rounded-xl mb-4",children:[b," ",(0,s.jsx)("button",{onClick:()=>j(""),className:"ml-2 underline",children:"cerrar"})]}),"dashboard"===t&&d&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Dashboard"}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[{label:"Usuarios",val:d.users.total,sub:"+".concat(d.users.recent_7d," esta semana"),color:"from-blue-600 to-blue-800"},{label:"Workers",val:d.users.workers,sub:"".concat(d.users.with_fcm," con push"),color:"from-emerald-600 to-emerald-800"},{label:"Demandas",val:d.demands.total,sub:"".concat(d.demands.today," hoy"),color:"from-yellow-600 to-yellow-800"},{label:"Completadas",val:d.demands.completed,sub:"$".concat(F(d.revenue.total)),color:"from-purple-600 to-purple-800"}].map((e,a)=>(0,s.jsxs)("div",{className:"bg-gradient-to-br ".concat(e.color," rounded-2xl p-5"),children:[(0,s.jsx)("p",{className:"text-sm text-white/70",children:e.label}),(0,s.jsx)("p",{className:"text-3xl font-bold mt-1",children:F(e.val)}),(0,s.jsx)("p",{className:"text-xs text-white/50 mt-1",children:e.sub})]},a))}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{label:"Pendientes",val:d.demands.pending,color:"text-yellow-400"},{label:"Tomadas",val:d.demands.taken,color:"text-blue-400"},{label:"Completadas",val:d.demands.completed,color:"text-emerald-400"},{label:"Canceladas",val:d.demands.cancelled,color:"text-red-400"},{label:"Categor\xedas",val:d.categories,color:"text-purple-400"}].map((e,a)=>(0,s.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-gray-800",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.label}),(0,s.jsx)("p",{className:"text-2xl font-bold ".concat(e.color),children:F(e.val)})]},a))})]}),"users"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Usuarios"}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar nombre, email, tel\xe9fono...",value:h,onChange:e=>u(e.target.value),onKeyDown:e=>"Enter"===e.key&&P(),className:"flex-1 max-w-md bg-gray-900 border border-gray-700 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-emerald-500"}),(0,s.jsxs)("select",{value:D,onChange:e=>S(e.target.value),className:"bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"Todos"}),(0,s.jsx)("option",{value:"worker",children:"Workers"}),(0,s.jsx)("option",{value:"client",children:"Clientes"})]}),(0,s.jsx)("button",{onClick:P,className:"bg-emerald-600 hover:bg-emerald-700 px-4 py-2 rounded-xl text-sm font-bold",children:"Buscar"})]}),(0,s.jsx)("div",{className:"bg-gray-900 rounded-2xl border border-gray-800 overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-800/50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"ID"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Nombre"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Email"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Tipo"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Push"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Fecha"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Acciones"})]})}),(0,s.jsx)("tbody",{children:c.map(e=>(0,s.jsxs)("tr",{className:"border-t border-gray-800/50 hover:bg-gray-800/30",children:[(0,s.jsx)("td",{className:"px-4 py-3 text-gray-500",children:e.id}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.nickname&&(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["@",e.nickname]})]}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-400",children:e.email}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-bold ".concat("worker"===e.type?"bg-emerald-500/20 text-emerald-300":"bg-blue-500/20 text-blue-300"),children:e.type}),e.is_pioneer&&(0,s.jsx)("span",{className:"ml-1 text-yellow-400 text-xs",children:"⭐"}),e.is_business&&(0,s.jsx)("span",{className:"ml-1 text-purple-400 text-xs",children:"\uD83C\uDFE2"})]}),(0,s.jsx)("td",{className:"px-4 py-3",children:e.has_fcm?"✅":"❌"}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-500 text-xs",children:I(e.created_at)}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("button",{onClick:()=>B(e.id),className:"px-3 py-1 rounded-lg text-xs font-bold ".concat(e.is_active?"bg-red-500/20 text-red-300 hover:bg-red-500/30":"bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30"),children:e.is_active?"Desactivar":"Activar"})})]},e.id))})]})}),(0,s.jsxs)("div",{className:"flex justify-center gap-2 mt-4",children:[(0,s.jsx)("button",{disabled:f<=1,onClick:()=>N(e=>e-1),className:"px-4 py-2 bg-gray-800 rounded-lg text-sm disabled:opacity-30",children:"← Anterior"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-gray-400 text-sm",children:[f," / ",v]}),(0,s.jsx)("button",{disabled:f>=v,onClick:()=>N(e=>e+1),className:"px-4 py-2 bg-gray-800 rounded-lg text-sm disabled:opacity-30",children:"Siguiente →"})]})]}),"demands"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Demandas"}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar descripci\xf3n...",value:h,onChange:e=>u(e.target.value),onKeyDown:e=>"Enter"===e.key&&T(),className:"flex-1 max-w-md bg-gray-900 border border-gray-700 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-emerald-500"}),(0,s.jsxs)("select",{value:C,onChange:e=>k(e.target.value),className:"bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"Todos"}),(0,s.jsx)("option",{value:"pending",children:"Pendiente"}),(0,s.jsx)("option",{value:"taken",children:"Tomada"}),(0,s.jsx)("option",{value:"completed",children:"Completada"}),(0,s.jsx)("option",{value:"cancelled",children:"Cancelada"})]}),(0,s.jsx)("button",{onClick:T,className:"bg-emerald-600 hover:bg-emerald-700 px-4 py-2 rounded-xl text-sm font-bold",children:"Buscar"})]}),(0,s.jsx)("div",{className:"bg-gray-900 rounded-2xl border border-gray-800 overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-800/50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"ID"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Descripci\xf3n"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Cliente"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Categor\xeda"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Precio"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Estado"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Tipo"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Fecha"}),(0,s.jsx)("th",{className:"text-left px-4 py-3 text-gray-400 font-medium",children:"Acciones"})]})}),(0,s.jsx)("tbody",{children:i.map(e=>{var a;return(0,s.jsxs)("tr",{className:"border-t border-gray-800/50 hover:bg-gray-800/30",children:[(0,s.jsx)("td",{className:"px-4 py-3 text-gray-500",children:e.id}),(0,s.jsx)("td",{className:"px-4 py-3 max-w-xs truncate",children:e.description}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-400",children:(null===(a=e.client)||void 0===a?void 0:a.name)||"—"}),(0,s.jsx)("td",{className:"px-4 py-3",children:e.category&&(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-bold",style:{backgroundColor:e.category.color+"30",color:e.category.color},children:e.category.display_name})}),(0,s.jsxs)("td",{className:"px-4 py-3 font-mono",children:["$",F(e.offered_price)]}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-bold ".concat(O[e.status]||"bg-gray-500/20 text-gray-400"),children:e.status})}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-400 text-xs",children:e.type}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-500 text-xs",children:I(e.created_at)}),(0,s.jsx)("td",{className:"px-4 py-3",children:"pending"===e.status&&(0,s.jsx)("button",{onClick:()=>L(e.id),className:"px-3 py-1 rounded-lg text-xs font-bold bg-red-500/20 text-red-300 hover:bg-red-500/30",children:"Cancelar"})})]},e.id)})})]})}),(0,s.jsxs)("div",{className:"flex justify-center gap-2 mt-4",children:[(0,s.jsx)("button",{disabled:f<=1,onClick:()=>N(e=>e-1),className:"px-4 py-2 bg-gray-800 rounded-lg text-sm disabled:opacity-30",children:"← Anterior"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-gray-400 text-sm",children:[f," / ",v]}),(0,s.jsx)("button",{disabled:f>=v,onClick:()=>N(e=>e+1),className:"px-4 py-2 bg-gray-800 rounded-lg text-sm disabled:opacity-30",children:"Siguiente →"})]})]}),"categories"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold mb-4",children:["Categor\xedas (",m.length,")"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:m.map(e=>(0,s.jsxs)("div",{className:"bg-gray-900 rounded-xl border border-gray-800 p-4 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:e.color+"20"},children:e.icon}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-bold",children:e.display_name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.slug})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-sm font-bold text-emerald-400",children:[e.workers_count," ",(0,s.jsx)("span",{className:"text-gray-500 font-normal",children:"workers"})]}),(0,s.jsxs)("p",{className:"text-sm font-bold text-yellow-400",children:[e.service_requests_count," ",(0,s.jsx)("span",{className:"text-gray-500 font-normal",children:"demandas"})]})]})]},e.id))})]}),g&&(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-gray-700 border-t-emerald-500 rounded-full animate-spin"})})]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4976)}),_N_E=e.O()}]);